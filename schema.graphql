enum ServiceStatus {
  Filled
  Confirmed
  Rejected
  Finished
  Opened
}

enum PaymentType {
  Release
  Reimburse
}

type Service @entity {
  id: ID! # service token id
  createdAt: BigInt # timestamp of block creation
  updatedAt: BigInt # timestamp of the last change
  status: ServiceStatus! # service status
  buyer: User # service buyer
  seller: User # service seller
  sender: User # user that created the service (buyer or seller)
  recipient: User # other participating user (seller or buyer)
  uri: String # metadata URI of service
  transactionId: String # Escrow transaction id of service
  proposals: [Proposal!] @derivedFrom(field: "service") # proposals for this service
}

type Review @entity {
  id: ID! # review token id
  service: Service! # service this review is for
  to: User! # reviewed user
  uri: String! # metadata URI of review
}

type User @entity {
  id: ID! # user token id
  address: String! # wallet address of user
  uri: String! # metadata URI of profile
  handle: String! # handle of user
  withPoh: Boolean! # whether user has proof of identity
  numReviews: BigInt! # number of reviews user has received
  rating: BigDecimal! # average rating from reviews user has received
  reviews: [Review!] @derivedFrom(field: "to") # reviews of user
  buyerServices: [Service!] @derivedFrom(field: "buyer") # services user is an buyer for
  sellerServices: [Service!] @derivedFrom(field: "seller") # services user is an seller for
}

enum ProposalStatus {
  Pending
  Validated
  Rejected
}

type Proposal @entity {
  id: ID! # concatenation of serviceId + seller TalentLayerId
  service: Service! # service entity
  createdAt: BigInt # timestamp of block creation
  updatedAt: BigInt # timestamp of the last change
  status: ProposalStatus! # Proposal status
  seller: User # Proposal seller
  rateToken: Bytes # Rate token
  rateAmount: BigInt # Rate amount
  uri: String! # metadata URI of service
}

#Payment sender will always be the Escrow Contract
type Payment @entity {
  id: ID! # autogenerated id
  service: Service! # service entity
  amount: BigInt # payment amount
  rateToken: Bytes # Rate token
  paymentType: String # Whether the payment is a release or a reimbursement
  transactionHash: String # Transaction hash of the transfer
}
